apiVersion: kuttl.dev/v1beta1
kind: TestStep
commands:
- script: |
    route_URL=$(oc get routes -o jsonpath="{.items[*]['spec.host']}" --field-selector metadata.name=example-argocd-server -n $NAMESPACE)
    status_URL=$(oc get argocd -o jsonpath="{.items[*]['status.host']}" -n $NAMESPACE)

    echo -e "route_URL:${route_URL}\nstatus_URL:${status_URL}"

    sleep 10
    
    route_URL=$(oc get routes -o jsonpath="{.items[*]['spec.host']}" --field-selector metadata.name=example-argocd-server -n $NAMESPACE)
    status_URL=$(oc get argocd -o jsonpath="{.items[*]['status.host']}" -n $NAMESPACE)

    if test "${status_URL}" != ""; then
      echo "Error: status.host should not be present in argocd"
      exit 1
    fi
    exit 0