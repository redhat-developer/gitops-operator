apiVersion: kuttl.dev/v1beta1
kind: TestStep
commands:
# patches the subscription to set an environment variable
- script: |
    if [ -z $CI ]; then 

      oc patch -n openshift-operators subscription openshift-gitops-operator \
        --type merge --patch '{"spec": {"config": {"env": [{"name": "DISABLE_DEFAULT_ARGOCD_INSTANCE", "value": "true"}]}}}'

    else
    
      oc patch -n openshift-operators subscription gitops-operator-v1-8-0-sub \
        --type merge --patch '{"spec": {"config": {"env": [{"name": "DISABLE_DEFAULT_ARGOCD_INSTANCE", "value": "true"}]}}}'
    fi
- script: sleep 20
